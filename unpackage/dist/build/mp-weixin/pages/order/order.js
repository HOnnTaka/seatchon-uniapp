"use strict";const e=require("../../common/vendor.js");if(!Array){(e.resolveComponent("uni-section")+e.resolveComponent("uni-list-item")+e.resolveComponent("uni-list")+e.resolveComponent("uni-load-more")+e.resolveComponent("unicloud-db")+e.resolveComponent("uni-card"))()}Math||((()=>"../../uni_modules/uni-section/components/uni-section/uni-section.js")+(()=>"../../uni_modules/uni-list/components/uni-list-item/uni-list-item.js")+(()=>"../../uni_modules/uni-list/components/uni-list/uni-list.js")+(()=>"../../uni_modules/uni-load-more/components/uni-load-more/uni-load-more.js")+(()=>"../../node-modules/@dcloudio/uni-components/lib/unicloud-db/unicloud-db.js")+(()=>"../../uni_modules/uni-card/components/uni-card/uni-card.js"))();const t={__name:"order",setup(t){const o=e.ref(e.index.getStorageSync("userinfo")),i=e.ref(!1),n=e.ref({orderDB:!1,adminDB:!1}),a=getCurrentPages().find((e=>"pages/order/order"===e.route)),r=e.Ws.database(),d=e.ref([r.collection("order").where('userId ==  "216124125"').field("chartId,x,y,userId").getTemp(),r.collection("seat-chart").field("_id,effectiveTimeRange,selectableTimeRange,title,note").getTemp()]);e.onShow((async()=>{e.index.startPullDownRefresh(),setTimeout((()=>{i.value=!0}),100)})),e.onHide((async()=>{i.value=!1}));const s=async t=>{await a.$vm.$refs[t].loadMore(),e.index.vibrateShort()},l=async t=>{n.value[t]=!0,await a.$vm.$refs[t].loadData({clear:!0}),setTimeout((()=>{e.index.stopPullDownRefresh(),n.value[t]=!1,e.index.vibrateShort()}))};return e.onPullDownRefresh((()=>{l("orderDB"),l("adminDB")})),(t,a)=>({a:e.p({title:"我的选座",type:"line"}),b:e.w((({data:t,loading:o,hasMore:i,error:n,options:a},r,d)=>e.e({a:n},n?{b:e.t(n.message)}:{},{c:e.f(t,((t,o,i)=>{return{a:e.t(t.chartId[0].title),b:e.t(t.chartId[0].note),c:e.t((n=t.chartId[0].effectiveTimeRange,n.join(" 至 "))),d:e.t(t.x),e:e.t(t.y),f:t.chartId[0]._id,g:"723f83b7-4-"+d+"-"+i+",723f83b7-3-"+d,h:e.p({clickable:!0,showArrow:!0,to:"/pages/detail/detail?chartId="+t.chartId[0]._id,title:t.chartId[0].title,note:t.chartId[0].note})};var n})),d:"723f83b7-3-"+d+",723f83b7-2",e:"723f83b7-5-"+d+",723f83b7-2",f:e.p({status:o?"loading":i?"default":"no-more"}),g:d,h:r})),{name:"d",path:"b",vueId:"723f83b7-2,723f83b7-0"}),c:e.sr("orderDB","723f83b7-2,723f83b7-0"),d:e.p({"page-size":10,collection:d.value,where:`userId=='${o.value._id}'`,orderby:"orderTime desc"}),e:n.value.orderDB,f:e.o((e=>s("orderDB"))),g:e.o((e=>l("orderDB"))),h:e.p({padding:"0"}),i:e.p({title:"我的管理",type:"line"}),j:e.w((({data:t,loading:o,hasMore:i,error:n,options:a},r,d)=>e.e({a:n},n?{b:e.t(n.message)}:{},{c:e.f(t,((t,o,i)=>({a:e.t(t.title),b:e.t(t.note),c:e.t(t.administrators.length),d:t._id,e:"723f83b7-10-"+d+"-"+i+",723f83b7-9-"+d,f:e.p({clickable:!0,showArrow:!0,to:"/pages/detail/detail?chartId="+t._id,title:t.title,note:t.note})}))),d:"723f83b7-9-"+d+",723f83b7-8",e:"723f83b7-11-"+d+",723f83b7-8",f:e.p({status:o?"loading":i?"default":"no-more"}),g:d,h:r})),{name:"d",path:"j",vueId:"723f83b7-8,723f83b7-6"}),k:e.sr("adminDB","723f83b7-8,723f83b7-6"),l:e.p({collection:"seat-chart","page-size":10,field:"title,note,administrators",where:`in('${o.value._id}', administrators)`,orderby:"createTime desc"}),m:n.value.adminDB,n:e.o((e=>s("adminDB"))),o:e.o((e=>l("adminDB"))),p:e.p({padding:"0"}),q:e.s(i.value?"transition: all .5s ease; opacity: 1":"")})}},o=e._export_sfc(t,[["__scopeId","data-v-723f83b7"]]);wx.createPage(o);
