"use strict";const e=require("../../common/vendor.js");if(!Array){(e.resolveComponent("uni-section")+e.resolveComponent("uni-list-item")+e.resolveComponent("uni-list")+e.resolveComponent("uni-load-more")+e.resolveComponent("unicloud-db")+e.resolveComponent("uni-card"))()}Math||((()=>"../../uni_modules/uni-section/components/uni-section/uni-section.js")+(()=>"../../uni_modules/uni-list/components/uni-list-item/uni-list-item.js")+(()=>"../../uni_modules/uni-list/components/uni-list/uni-list.js")+(()=>"../../uni_modules/uni-load-more/components/uni-load-more/uni-load-more.js")+(()=>"../../node-modules/@dcloudio/uni-components/lib/unicloud-db/unicloud-db.js")+(()=>"../../uni_modules/uni-card/components/uni-card/uni-card.js"))();const a={__name:"order",setup(a){const t=e.ref(e.index.getStorageSync("userinfo")),o=e.ref(!1),n=e.ref({orderDB:!1,adminDB:!1}),i=getCurrentPages().find((e=>"pages/order/order"===e.route)),r=e.Ws.database(),d=e.ref([r.collection("order").where('userId ==  "216124125"').field("chartId,x,y,userId").getTemp(),r.collection("seat-chart").field("_id,effectiveTimeRange,selectableTimeRange,title,note").getTemp()]);e.onShow((async()=>{e.index.startPullDownRefresh(),setTimeout((()=>{o.value=!0}),100)})),e.onHide((async()=>{o.value=!1}));const s=async a=>{await i.$vm.$refs[a].loadMore(),e.index.vibrateShort()},l=async a=>{n.value[a]=!0,await i.$vm.$refs[a].loadData({clear:!0}),setTimeout((()=>{e.index.stopPullDownRefresh(),n.value[a]=!1,e.index.vibrateShort()}))};return e.onPullDownRefresh((()=>{l("orderDB"),l("adminDB")})),(a,i)=>({a:e.p({title:"我的选座",type:"line"}),b:e.w((({data:a,loading:t,hasMore:o,error:n,options:i},r,d)=>e.e({a:n},n?{b:e.t(console.log(n.message))}:{},{c:e.f(a,((a,t,o)=>{return{a:e.t(a.chartId[0].title),b:e.t(a.chartId[0].note),c:e.t((n=a.chartId[0].effectiveTimeRange,n.join(" 至 "))),d:e.t(a.x),e:e.t(a.y),f:a.chartId[0]._id,g:"afa3cf41-4-"+d+"-"+o+",afa3cf41-3-"+d,h:e.p({clickable:!0,showArrow:!0,to:"/pages/detail/detail?chartId="+a.chartId[0]._id,title:a.chartId[0].title,note:a.chartId[0].note})};var n})),d:"afa3cf41-3-"+d+",afa3cf41-2",e:"afa3cf41-5-"+d+",afa3cf41-2",f:e.p({status:t?"loading":o?"default":"no-more"}),g:d,h:r})),{name:"d",path:"b",vueId:"afa3cf41-2,afa3cf41-0"}),c:e.sr("orderDB","afa3cf41-2,afa3cf41-0"),d:e.p({"page-size":10,collection:d.value,where:`userId=='${t.value._id}'`,orderby:"orderTime desc"}),e:n.value.orderDB,f:e.o((e=>s("orderDB"))),g:e.o((e=>l("orderDB"))),h:e.p({padding:"0"}),i:e.p({title:"我的管理",type:"line"}),j:e.w((({data:a,loading:t,hasMore:o,error:n,options:i},r,d)=>e.e({a:n},n?{b:e.t(console.log(n.message))}:{},{c:e.f(a,((a,t,o)=>({a:e.t(a.title),b:e.t(a.note),c:e.t(a.administrators.length),d:a._id,e:"afa3cf41-10-"+d+"-"+o+",afa3cf41-9-"+d,f:e.p({clickable:!0,showArrow:!0,to:"/pages/detail/detail?chartId="+a._id,title:a.title,note:a.note})}))),d:"afa3cf41-9-"+d+",afa3cf41-8",e:"afa3cf41-11-"+d+",afa3cf41-8",f:e.p({status:t?"loading":o?"default":"no-more"}),g:d,h:r})),{name:"d",path:"j",vueId:"afa3cf41-8,afa3cf41-6"}),k:e.sr("adminDB","afa3cf41-8,afa3cf41-6"),l:e.p({collection:"seat-chart","page-size":10,field:"title,note,administrators",where:`in('${t.value._id}', administrators)`,orderby:"createTime desc"}),m:n.value.adminDB,n:e.o((e=>s("adminDB"))),o:e.o((e=>l("adminDB"))),p:e.p({padding:"0"}),q:e.s(o.value?"transition: all .5s ease; opacity: 1":"")})}},t=e._export_sfc(a,[["__scopeId","data-v-afa3cf41"]]);wx.createPage(t);
