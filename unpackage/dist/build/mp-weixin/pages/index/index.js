"use strict";const e=require("../../common/vendor.js");if(!Array){(e.resolveComponent("uni-search-bar")+e.resolveComponent("uni-list-item")+e.resolveComponent("uni-list")+e.resolveComponent("uni-fab"))()}Math||((()=>"../../uni_modules/uni-search-bar/components/uni-search-bar/uni-search-bar.js")+(()=>"../../uni_modules/uni-list/components/uni-list-item/uni-list-item.js")+(()=>"../../uni_modules/uni-list/components/uni-list/uni-list.js")+(()=>"../../uni_modules/uni-fab/components/uni-fab/uni-fab.js"))();const t={__name:"index",setup(t){const a=e.ref(""),n=e.ref([]),o=e.ref({});e.onLoad((async()=>{e.index.showLoading({title:"加载中",mask:!0});try{const{code:t}=await e.index.login(),{result:a}=await e.Ws.callFunction({name:"login",data:{code:t}});o.value=a,e.index.setStorageSync("userinfo",a),console.log(o.value)}catch(t){e.index.showToast({title:t.message,icon:"none"}),console.log(t)}e.index.hideLoading()})),e.onShow((async()=>{i(!1)}));const i=async(t=!0)=>{t&&e.index.showLoading({title:"加载中"});const a=e.Ws.database(),o=await a.collection("seat-chart").aggregate().project({_id:1,title:1,note:1,creator:1,creatorId:1,selectableTimeRange:1,effectiveTimeRange:1}).end();n.value=o.result.data,e.index.hideLoading()},s=e=>e.join(" 至 "),l=async()=>{},c=()=>{e.index.navigateTo({url:"/pages/createSeatChart/createSeatChart"})};return(t,i)=>e.e({a:e.o(l),b:e.o((e=>a.value=e)),c:e.p({placeholder:"请输入搜索内容",modelValue:a.value}),d:e.f(n.value,((t,a,n)=>({a:e.t(t.title),b:e.t(t.note),c:e.t(s(t.selectableTimeRange)),d:e.t(s(t.effectiveTimeRange)),e:e.t("选座中"),f:t.chartId,g:"a3ac0803-2-"+n+",a3ac0803-1",h:e.p({clickable:!0,link:!0,to:"/pages/detail/detail?chartId="+t._id,title:t.title,note:t.note})}))),e:1==o.value.type},1==o.value.type?{f:e.sr("fab","a3ac0803-3"),g:e.o(c),h:e.p({pattern:{buttonColor:"#07c160"},horizontal:"right",vertical:"bottom"})}:{})}},a=e._export_sfc(t,[["__scopeId","data-v-a3ac0803"]]);wx.createPage(a);
