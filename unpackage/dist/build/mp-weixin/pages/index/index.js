"use strict";const e=require("../../common/vendor.js");if(!Array){(e.resolveComponent("uni-fab")+e.resolveComponent("uni-search-bar")+e.resolveComponent("uni-list-item")+e.resolveComponent("uni-list")+e.resolveComponent("uni-load-more")+e.resolveComponent("unicloud-db")+e.resolveComponent("uni-card"))()}Math||((()=>"../../uni_modules/uni-fab/components/uni-fab/uni-fab.js")+(()=>"../../uni_modules/uni-search-bar/components/uni-search-bar/uni-search-bar.js")+(()=>"../../uni_modules/uni-list/components/uni-list-item/uni-list-item.js")+(()=>"../../uni_modules/uni-list/components/uni-list/uni-list.js")+(()=>"../../uni_modules/uni-load-more/components/uni-load-more/uni-load-more.js")+(()=>"../../node-modules/@dcloudio/uni-components/lib/unicloud-db/unicloud-db.js")+(()=>"../../uni_modules/uni-card/components/uni-card/uni-card.js"))();const o={__name:"index",setup(o){const a=getCurrentPages().find((e=>"pages/index/index"===e.route)),n=e.ref("");e.ref([]),e.ref({});const t=e.ref({}),i=e.ref(!1),s=e.ref(!1),l=e.ref("");e.onLoad((async()=>{})),e.onShow((async()=>{setTimeout((()=>{i.value=!0,e.index.startPullDownRefresh()}),100)})),e.onHide((async()=>{i.value=!1}));const r=async()=>{var o;s.value=!0,t.value=e.index.getStorageSync("userinfo"),console.log(t.value),await(null==(o=a.$vm.$refs.udb)?void 0:o.loadData({clear:!0})),setTimeout((()=>{e.index.stopPullDownRefresh(),s.value=!1,e.index.vibrateShort()}))},u=async o=>{console.log(o),await a.$vm.$refs.udb.loadMore(),e.index.vibrateShort()};e.onPullDownRefresh(r);const d=e=>e.join(" 至 "),c=e=>{const o=new Date((new Date).toISOString().substring(0,10)).getTime(),a=[new Date(e[0]).getTime(),new Date(e[1]).getTime()];return o>=a[0]&&o<=a[1]},m=async()=>{const e=n.value.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");console.log(e),l.value=`${new RegExp(e,"i")}.test(title) || ${new RegExp(e,"i")}.test(note)`,setTimeout((async()=>{var e;await(null==(e=a.$vm.$refs.udb)?void 0:e.loadData({clear:!0}))}))},f=async()=>{l.value="",setTimeout((async()=>{var e;await(null==(e=a.$vm.$refs.udb)?void 0:e.loadData({clear:!0}))}))},v=()=>{e.index.navigateTo({url:"/pages/createSeatChart/createSeatChart"})};return(o,a)=>e.e({a:1==t.value.type},1==t.value.type?{b:e.sr("fab","0f217ab0-0"),c:e.o(v),d:e.p({pattern:{buttonColor:"#2979ff"},horizontal:"right",vertical:"bottom"})}:{},{e:e.o(m),f:e.o(f),g:e.o((e=>n.value=e)),h:e.p({bgColor:"#fff",radius:"5",placeholder:"请输入搜索内容",modelValue:n.value}),i:e.w((({data:o,loading:a,hasMore:n,error:i,options:s},l,r)=>e.e({a:i},i?{b:e.t(console.log(i.message))}:{},{c:e.f(o,((o,a,n)=>({a:e.t(o.title),b:e.t(o.note),c:e.t(d(o.selectableTimeRange)),d:e.t(d(o.effectiveTimeRange)),e:c(o.selectableTimeRange)?"":1,f:c(o.effectiveTimeRange)?"":1,g:o._id,h:e.o((a=>(async o=>{t.value=e.index.getStorageSync("userinfo"),t.value?(e.index.showLoading({title:"加载中"}),e.index.navigateTo({url:`/pages/detail/detail?chartId=${o._id}`})):(await e.index.showModal({title:"提示",content:"还未登录，是否前往登录？",showCancel:!0,confirmText:"前往登录"})).confirm&&e.index.switchTab({url:"/pages/user/user"})})(o)),o._id),i:"0f217ab0-5-"+r+"-"+n+",0f217ab0-4-"+r,j:e.p({clickable:!0,showArrow:!0,title:o.title,note:o.note})}))),d:"0f217ab0-4-"+r+",0f217ab0-3",e:"0f217ab0-6-"+r+",0f217ab0-3",f:e.p({status:a?"loading":n?"more":"no-more"}),g:r,h:l})),{name:"d",path:"i",vueId:"0f217ab0-3,0f217ab0-2"}),j:e.p({showArrow:!0}),k:e.sr("udb","0f217ab0-3,0f217ab0-2"),l:e.p({collection:"seat-chart","page-size":10,orderby:"title desc",where:l.value}),m:s.value,n:e.o(u),o:e.o(r),p:e.p({padding:"0"}),q:e.s(i.value?"transition: all .5s ease; opacity: 1":"")})}},a=e._export_sfc(o,[["__scopeId","data-v-0f217ab0"]]);wx.createPage(a);
