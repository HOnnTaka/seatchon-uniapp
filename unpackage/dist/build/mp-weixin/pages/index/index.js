"use strict";const e=require("../../common/vendor.js");if(!Array){(e.resolveComponent("uni-fab")+e.resolveComponent("uni-search-bar")+e.resolveComponent("uni-list-item")+e.resolveComponent("uni-list")+e.resolveComponent("uni-load-more")+e.resolveComponent("unicloud-db")+e.resolveComponent("uni-card"))()}Math||((()=>"../../uni_modules/uni-fab/components/uni-fab/uni-fab.js")+(()=>"../../uni_modules/uni-search-bar/components/uni-search-bar/uni-search-bar.js")+(()=>"../../uni_modules/uni-list/components/uni-list-item/uni-list-item.js")+(()=>"../../uni_modules/uni-list/components/uni-list/uni-list.js")+(()=>"../../uni_modules/uni-load-more/components/uni-load-more/uni-load-more.js")+(()=>"../../node-modules/@dcloudio/uni-components/lib/unicloud-db/unicloud-db.js")+(()=>"../../uni_modules/uni-card/components/uni-card/uni-card.js"))();const o={__name:"index",setup(o){const n=getCurrentPages().find((e=>"pages/index/index"===e.route)),t=e.ref("");e.ref([]),e.ref({});const a=e.ref({}),i=e.ref(!1),s=e.ref(!1),l=e.ref("");e.onLoad((async()=>{})),e.onShow((async()=>{e.index.startPullDownRefresh(),setTimeout((()=>{i.value=!0}),100)})),e.onHide((async()=>{i.value=!1}));const r=async()=>{var o;s.value=!0,a.value=e.index.getStorageSync("userinfo"),await(null==(o=n.$vm.$refs.udb)?void 0:o.loadData({clear:!0})),setTimeout((()=>{e.index.stopPullDownRefresh(),s.value=!1,e.index.vibrateShort()}))},u=async o=>{console.log(o),await n.$vm.$refs.udb.loadMore(),e.index.vibrateShort()};e.onPullDownRefresh(r);const d=e=>e.join(" 至 "),c=e=>{const o=(new Date).getTime(),{selectableTimeRange:n,effectiveTimeRange:t}=e,a=[new Date(n[0]).getTime(),new Date(n[1]).getTime()],i=[new Date(t[0]).getTime(),new Date(t[1]).getTime()];return o>i[0]&&o<i[1]?"生效中":o>a[0]&&o<a[1]?"选座中":o<a[0]?"未开始":o>i[1]?"已结束":void 0},m=async()=>{const e=t.value.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");console.log(e),l.value=`${new RegExp(e,"i")}.test(title) || ${new RegExp(e,"i")}.test(note)`,setTimeout((async()=>{var e;await(null==(e=n.$vm.$refs.udb)?void 0:e.loadData({clear:!0}))}))},v=async()=>{l.value="",setTimeout((async()=>{var e;await(null==(e=n.$vm.$refs.udb)?void 0:e.loadData({clear:!0}))}))},b=()=>{e.index.navigateTo({url:"/pages/createSeatChart/createSeatChart"})};return(o,n)=>e.e({a:1==a.value.type},1==a.value.type?{b:e.sr("fab","d20be561-0"),c:e.o(b),d:e.p({pattern:{buttonColor:"#2979ff"},horizontal:"right",vertical:"bottom"})}:{},{e:e.o(m),f:e.o(v),g:e.o((e=>t.value=e)),h:e.p({bgColor:"#fff",radius:"5",placeholder:"请输入搜索内容",modelValue:t.value}),i:e.w((({data:o,loading:n,hasMore:t,error:i,options:s},l,r)=>e.e({a:i},i?{b:e.t(i.message)}:{},{c:e.f(o,((o,n,t)=>({a:e.t(o.title),b:e.t(o.note),c:e.t(d(o.selectableTimeRange)),d:e.t(d(o.effectiveTimeRange)),e:e.t(c(o)),f:o._id,g:e.o((n=>(async o=>{a.value?(e.index.showLoading({title:"加载中"}),e.index.navigateTo({url:`/pages/detail/detail?chartId=${o._id}`})):(await e.index.showModal({title:"提示",content:"还未登录，是否前往登录？",showCancel:!0,confirmText:"前往登录"})).confirm&&e.index.switchTab({url:"/pages/user/user"})})(o)),o._id),h:"d20be561-5-"+r+"-"+t+",d20be561-4-"+r,i:e.p({clickable:!0,showArrow:!0,title:o.title,note:o.note})}))),d:"d20be561-4-"+r+",d20be561-3",e:"d20be561-6-"+r+",d20be561-3",f:e.p({status:n?"loading":t?"more":"no-more"}),g:r,h:l})),{name:"d",path:"i",vueId:"d20be561-3,d20be561-2"}),j:e.p({showArrow:!0}),k:e.sr("udb","d20be561-3,d20be561-2"),l:e.p({collection:"seat-chart","page-size":10,orderby:"title desc",where:l.value}),m:s.value,n:e.o(u),o:e.o(r),p:e.p({padding:"0"}),q:e.s(i.value?"transition: all .5s ease; opacity: 1":"")})}},n=e._export_sfc(o,[["__scopeId","data-v-d20be561"]]);wx.createPage(n);
